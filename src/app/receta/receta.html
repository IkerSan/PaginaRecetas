<div class="container mt-4">
  <div class="row mb-4">
    <div class="col-md-4">
      <label for="filtro" class="form-label">Filtrar por valoración mínima:</label>
      <select id="filtro" class="form-select" [(ngModel)]="minRating" (change)="filtrarRecetas()">
        <option [value]="0">Todas</option>
        <option [value]="1">1 Estrella o más</option>
        <option [value]="2">2 Estrellas o más</option>
        <option [value]="3">3 Estrellas o más</option>
        <option [value]="4">4 Estrellas o más</option>
        <option [value]="5">5 Estrellas</option>
      </select>
    </div>
  </div>

  <div class="row g-4 mb-5">
    <!-- Cards de recetas -->
    <!-- Usamos un for para mostrar las recetas que haya en la lista -->
    <div class="col-md-6 col-lg-3" *ngFor="let receta of recetasFiltradas">
      <div class="card h-100 shadow-sm">
        <img
          [src]="receta.imagen"
          class="card-img-top"
          [alt]="receta.nombre"
          style="cursor: pointer; height: 200px; object-fit: cover"
          [routerLink]="['/receta', receta.id]"
        />
        <div class="card-body d-flex flex-column">
          <h5
            class="card-title text-primary"
            [routerLink]="['/receta', receta.id]"
            style="cursor: pointer"
          >
            {{ receta.nombre }}
          </h5>

          <div class="mb-2">
            <span class="text-warning fw-bold">
              <span *ngFor="let _ of [].constructor(5); let i = index">
                {{ i < Math.round(receta.rating) ? '★' : '☆' }}
              </span>
            </span>
            <small class="text-muted ms-2">({{ receta.rating }} / {{ receta.votes }} votos)</small>
          </div>

          <p class="card-text mb-2">Ingredientes:</p>
          <ul class="list-unstyled flex-grow-1">
            <li *ngFor="let ingrediente of receta.ingredientes">• {{ ingrediente }}</li>
          </ul>

          <div class="mt-auto pt-3 border-top">
            <small class="d-block mb-1">Tu voto:</small>
            <div class="d-flex justify-content-between">
              <button
                *ngFor="let star of [1, 2, 3, 4, 5]"
                type="button"
                class="btn btn-sm btn-outline-warning p-1"
                style="line-height: 1"
                (click)="votar(receta, star)"
              >
                ★
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Formulario al final -->
  <div class="row mt-5" id="anyadir">
    <div class="col-12">
      <h3 class="mb-4 border-bottom pb-2">Añadir nueva receta</h3>
      <app-contact-form (recetaAgregada)="agregarReceta($event)"></app-contact-form>
    </div>
  </div>
</div>
